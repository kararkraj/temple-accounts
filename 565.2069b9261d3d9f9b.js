"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[565],{4565:(x,_,m)=>{m.r(_),m.d(_,{EditTemplePage:()=>v});var g=m(467),e=m(3953),i=m(4341),l=m(5751),f=m(2193),T=m(9228);function h(o,d){1&o&&e.nrm(0,"ion-item-divider")}function E(o,d){if(1&o){const a=e.RV6();e.DNE(0,h,1,0,"ion-item-divider"),e.j41(1,"ion-item",9),e.nrm(2,"ion-input",11),e.j41(3,"ion-select",12)(4,"ion-select-option",13),e.EFF(5,"Admin"),e.k0s(),e.j41(6,"ion-select-option",14),e.EFF(7,"Member"),e.k0s(),e.j41(8,"ion-select-option",15),e.EFF(9,"Viewer"),e.k0s()(),e.j41(10,"ion-button",16),e.bIt("click",function(){const n=e.eBV(a).$index,r=e.XpG();return e.Njj(r.deleteUser(n))}),e.nrm(11,"ion-icon",17),e.k0s()()}if(2&o){const a=d.$implicit;e.vxM(d.$index>0?0:-1),e.R7$(),e.Y8G("formGroup",a)}}function b(o,d){if(1&o){const a=e.RV6();e.j41(0,"ion-grid",10)(1,"ion-row")(2,"ion-col")(3,"ion-button",18),e.bIt("click",function(){e.eBV(a);const n=e.XpG();return e.Njj(n.resetForm())}),e.EFF(4,"Reset"),e.k0s()(),e.j41(5,"ion-col")(6,"ion-button",19),e.EFF(7,"Submit"),e.k0s()()()()}}let v=(()=>{var o;class d extends f.AddTemplePage{constructor(){super(...arguments),this.router=(0,e.WQX)(T.Ix)}ngOnInit(){var t=this;return(0,g.A)(function*(){t.title="Edit Temple";try{const n=yield t.templeService.getTempleById(t.templeId);t.patchTempleForm(n),t.temple=n}catch(n){t.toaster.presentToast({message:n.code,color:"danger"}),t.router.navigate(["tabs"],{replaceUrl:!0})}})()}patchTempleForm(t){let n=[];for(let r in t.roles)"owner"!=t.roles[r]&&(this.addUser(),n.push({email:r,role:t.roles[r]}));this.templeForm.patchValue({name:t.name,address:t.address,roles:n})}onSubmit(){var t=this;return(0,g.A)(function*(){if(t.templeForm.valid&&t.templeForm.dirty||Object.keys(t.temple.roles).length!==t.roles.length+1&&t.roles.valid){var n,r,p,u;const c={};if(null!==(n=t.templeForm.get("name"))&&void 0!==n&&n.dirty&&(c.name=null===(r=t.templeForm.get("name"))||void 0===r?void 0:r.value),null!==(p=t.templeForm.get("address"))&&void 0!==p&&p.dirty&&(c.address=null===(u=t.templeForm.get("address"))||void 0===u?void 0:u.value),Object.keys(t.temple.roles).length!==t.roles.length+1||t.roles.dirty){c.roles={},t.roles.value.forEach(s=>c.roles={[s.email]:s.role});for(let s in t.temple.roles)"owner"===t.temple.roles[s]&&(c.roles[s]="owner")}try{const s=yield t.templeService.updateTemple(t.templeId,c);t.temple={...t.temple,...s},t.toaster.presentToast({message:"Temple was updated successfully!",color:"success"})}catch(s){t.toaster.presentToast({message:`Error: ${s.code}`,color:"danger"}),console.error("Error updating document: ",s)}finally{t.resetForm()}}else t.templeForm.valid?yield t.toaster.presentToast({message:"Nothing to update.",color:"success"}):t.templeForm.markAllAsTouched()})()}resetForm(){this.roles.clear(),this.templeForm.reset(),this.patchTempleForm(this.temple)}}return(o=d).\u0275fac=(()=>{let a;return function(n){return(a||(a=e.xGo(o)))(n||o)}})(),o.\u0275cmp=e.VBU({type:o,selectors:[["app-edit-temple"]],standalone:!0,features:[e.Vt3,e.aNF],decls:27,vars:4,consts:[["slot","start"],["defaultHref","tabs/temples"],[3,"ngSubmit","formGroup"],["lines","none"],["formControlName","name","label","Temple Name *","label-placement","floating","placeholder","Enter temple name","type","text","name","templeName","required","","maxlength","100","helperText","Only a-z, A-Z and 0-9 characters allowed","errorText","Only a-z, A-Z and 0-9 characters allowed"],["formControlName","address","label","Temple Address *","label-placement","floating","placeholder","Enter temple address","name","templeAddress","required","","maxlength","500","helperText","Only a-z, A-Z, 0-9, comma, ., -` and new line characters allowed","errorText","Only a-z, A-Z, 0-9, comma, ., - and new line characters allowed","rows","3",3,"autoGrow"],["type","button","color","primary","shape","round",3,"click"],["slot","start","name","add-outline"],["formArrayName","roles"],["lines","none",3,"formGroup"],[1,"ion-no-padding"],["formControlName","email","label","Email *","label-placement","floating","placeholder","example@domain.com","type","text","name","email","required","","maxlength","100","minlength","5","helperText","example@domain.com","errorText","Invalid Email",1,"max-width-60"],["formControlName","role","required","","label","Role *","label-placement","floating",1,"ion-margin-start"],["value","admin"],["value","member"],["value","viewer"],["size","default",3,"click"],["slot","icon-only","name","close-circle-outline"],["expand","full","type","button","color","light",3,"click"],["expand","full","type","submit"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.k0s()()(),e.j41(6,"ion-content")(7,"form",2),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(8,"ion-item-group")(9,"ion-item-divider")(10,"ion-label"),e.EFF(11,"Temple details:"),e.k0s()(),e.j41(12,"ion-item",3),e.nrm(13,"ion-input",4),e.k0s(),e.j41(14,"ion-item",3),e.nrm(15,"ion-textarea",5),e.k0s()(),e.j41(16,"ion-item-group")(17,"ion-item-divider")(18,"ion-label"),e.EFF(19,"Share Temple with other users:"),e.k0s()(),e.j41(20,"ion-button",6),e.bIt("click",function(){return n.addUser()}),e.nrm(21,"ion-icon",7),e.EFF(22," Add user "),e.k0s(),e.qex(23,8),e.Z7z(24,E,12,2,"ion-item",9,e.Vm6),e.bVm(),e.k0s(),e.DNE(26,b,8,0,"ion-grid",10),e.k0s()()),2&t&&(e.R7$(5),e.JRh(n.title),e.R7$(2),e.Y8G("formGroup",n.templeForm),e.R7$(8),e.Y8G("autoGrow",!0),e.R7$(9),e.Dyx(n.roles.controls),e.R7$(2),e.vxM(n.canEdit?26:-1))},dependencies:[l.hU,l.ln,l.lO,i.X1,i.qT,i.BC,i.cb,i.YS,i.xh,i.tU,i.j4,i.JD,i.v8,l.W9,l.eU,l.BC,l.ai,l.Jm,l.nc,l.$w,l.QW,l.iq,l.uz,l.jh,l.Dg,l.he,l.el,l.Nm,l.Ip],styles:["@media (max-width: 560px){ion-input.amount-input[_ngcontent-%COMP%]{flex:20%}}@media (min-width: 561px) and (max-width: 1000px){ion-input.amount-input[_ngcontent-%COMP%]{flex:60%}}.input-disabled[_ngcontent-%COMP%], .textarea-disabled[_ngcontent-%COMP%]{opacity:.5}ion-item[_ngcontent-%COMP%]   ion-input.max-width-60[_ngcontent-%COMP%]{max-width:60%}ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{align-self:flex-start}"]}),d})()}}]);