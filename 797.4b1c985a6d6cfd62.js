"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[797],{7797:(A,p,s)=>{s.r(p),s.d(p,{AddEntryPage:()=>F});var d=s(467),e=s(3953),u=s(177),r=s(4341),o=s(7920),_=s(9650),g=s(4987),v=s(7990);const T=["ionSegment"],h=(a,m)=>m.id;function f(a,m){if(1&a&&(e.j41(0,"ion-select-option",11),e.EFF(1),e.k0s()),2&a){const l=m.$implicit;e.Y8G("value",l),e.R7$(),e.JRh(l.name)}}function S(a,m){if(1&a&&(e.j41(0,"ion-select-option",11),e.EFF(1),e.k0s()),2&a){const l=m.$implicit;e.Y8G("value",l),e.R7$(),e.Lme("",l.name," - (Rs. ",l.amount,")")}}function E(a,m){if(1&a){const l=e.RV6();e.j41(0,"ion-item",4)(1,"ion-select",16),e.bIt("selectionChange",function(i){e.eBV(l);const n=e.XpG();return e.Njj(n.onCharityTypeSelection(i))}),e.Z7z(2,S,2,3,"ion-select-option",11,h),e.k0s()()}if(2&a){const l=e.XpG();e.R7$(2),e.Dyx(l.charityTypes)}}function C(a,m){1&a&&(e.qex(0),e.j41(1,"ion-item",17),e.nrm(2,"ion-input",18),e.k0s(),e.j41(3,"ion-item",17),e.nrm(4,"ion-input",19),e.k0s(),e.bVm())}let F=(()=>{var a;class m{constructor(t,i,n,y,c){this.entryService=t,this.formBuilder=i,this.pdfService=n,this.loader=y,this.toaster=c,this.temples=[],this.charityTypes=[],this.updatedTemplesEffect=(0,e.QZP)(()=>{this.entryService.getTemplesUpdatedSignal(),this.getTemples()}),this.updatedCharityTypesEffect=(0,e.QZP)(()=>{this.entryService.getCharityTypesUpdatedSignal(),this.getCharityTypes()}),this.entryForm=this.formBuilder.group({title:[null,[r.k0.required]],name:[null,[r.k0.required,r.k0.maxLength(100),r.k0.pattern("[a-zA-Z0-9 ]+")]],temple:[null,[r.k0.required]],charityType:[null,[r.k0.required]],charityTypeName:[null,[r.k0.required,r.k0.maxLength(50)]],charityTypeAmount:[null,[r.k0.required,r.k0.min(1)]]})}ngOnInit(){}getTemples(){this.entryService.getTemples().then(t=>{this.temples=t,1===this.temples.length&&this.entryForm.patchValue({temple:this.temples[0]})})}getCharityTypes(){this.entryService.getCharityTypes().then(t=>{this.charityTypes=t,this.onPresetServiceSelection(),this.ionSegment.writeValue(this.charityTypes.length>0?"preset":"custom"),this.onSegmentChange(this.ionSegment.value)})}onSubmit(){var t=this;return(0,d.A)(function*(){if(t.entryForm.valid){const i=yield t.loader.create({message:"Adding temple..."});yield i.present();const n=t.entryForm.value;"custom"===t.ionSegment.value&&(n.charityType={id:0,name:n.charityTypeName,amount:n.charityTypeAmount});let y={...n,id:yield t.entryService.getEntryNextId(),createdOn:(new Date).toISOString()};t.entryService.addEntry(y).subscribe(c=>{t.pdfService.generateAndDownloadPDF(c),t.resetForm(),i.dismiss()})}else t.entryForm.markAllAsTouched()})()}onTempleSelection(t){}onCharityTypeSelection(t){}onSegmentChange(t){"custom"===t?this.onCustomServiceSelection():this.onPresetServiceSelection()}onPresetServiceSelection(){var t,i,n;0===this.charityTypes.length&&this.toaster.presentToast({message:"No preset services found. Go to Services => Add Service to add preset services.",color:"danger",duration:5e3}),null===(t=this.entryForm.get("charityTypeName"))||void 0===t||t.disable(),null===(i=this.entryForm.get("charityTypeAmount"))||void 0===i||i.disable(),null===(n=this.entryForm.get("charityType"))||void 0===n||n.enable(),1===this.charityTypes.length&&this.entryForm.patchValue({charityType:this.charityTypes[0]})}onCustomServiceSelection(){var t,i,n;null===(t=this.entryForm.get("charityType"))||void 0===t||t.disable(),null===(i=this.entryForm.get("charityTypeName"))||void 0===i||i.enable(),null===(n=this.entryForm.get("charityTypeAmount"))||void 0===n||n.enable()}resetForm(){let t={};1===this.temples.length&&(t.temple=this.temples[0]),this.entryForm.reset(t)}}return(a=m).\u0275fac=function(t){return new(t||a)(e.rXU(_.q),e.rXU(r.ok),e.rXU(g.C),e.rXU(o.Xi),e.rXU(v.W))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-add-entry"]],viewQuery:function(t,i){if(1&t&&e.GBs(T,5),2&t){let n;e.mGM(n=e.lsd())&&(i.ionSegment=n.first)}},standalone:!0,features:[e.aNF],decls:35,vars:2,consts:[["ionSegment",""],["slot","start"],[1,"container"],[3,"ngSubmit","formGroup"],["lines","full"],["formControlName","title","label","Title *","label-placement","floating","placeholder","Select title","required","","name","title"],["value","Sri."],["value","Smt."],["value","Kum."],["formControlName","name","label","Name *","label-placement","floating","placeholder","Enter name","type","text","name","name","required","","helperText","Only a-z, A-Z and 0-9 characters allowed","errorText","Only a-z, A-Z and 0-9 characters allowed"],["formControlName","temple","label","Temple *","label-placement","floating","placeholder","Select temple","required","","name","temple",3,"selectionChange"],[3,"value"],["value","preset",3,"ionChange"],["value","preset"],["value","custom"],["expand","full","type","submit"],["formControlName","charityType","label","Service *","label-placement","floating","placeholder","Select service","required","","name","service",3,"selectionChange"],["lines","none"],["formControlName","charityTypeName","label","Service Name *","label-placement","floating","placeholder","Enter service name","type","text","name","charityTypeName","required","","maxlength","50","helperText","Only a-z, A-Z and 0-9 characters allowed","errorText","Only a-z, A-Z and 0-9 characters allowed"],["formControlName","charityTypeAmount","label","Service Amount *","label-placement","floating","placeholder","1001","type","number","name","charityTypeAmount","equired","","min","1"]],template:function(t,i){if(1&t){const n=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Add Entry"),e.k0s()()(),e.j41(6,"ion-content")(7,"div",2)(8,"form",3),e.bIt("ngSubmit",function(){return e.eBV(n),e.Njj(i.onSubmit())}),e.j41(9,"ion-item",4)(10,"ion-select",5)(11,"ion-select-option",6),e.EFF(12,"Sri. (Shriman)"),e.k0s(),e.j41(13,"ion-select-option",7),e.EFF(14,"Smt. (Shrimati)"),e.k0s(),e.j41(15,"ion-select-option",8),e.EFF(16,"Kum. (Kumar/Kumari)"),e.k0s()()(),e.j41(17,"ion-item",4),e.nrm(18,"ion-input",9),e.k0s(),e.j41(19,"ion-item",4)(20,"ion-select",10),e.bIt("selectionChange",function(c){return e.eBV(n),e.Njj(i.onTempleSelection(c))}),e.Z7z(21,f,2,2,"ion-select-option",11,h),e.k0s()(),e.j41(23,"ion-segment",12,0),e.bIt("ionChange",function(c){return e.eBV(n),e.Njj(i.onSegmentChange(c.target.value))}),e.j41(25,"ion-segment-button",13)(26,"ion-label"),e.EFF(27,"Preset services"),e.k0s()(),e.j41(28,"ion-segment-button",14)(29,"ion-label"),e.EFF(30,"Custom service"),e.k0s()()(),e.DNE(31,E,4,0,"ion-item",4)(32,C,5,0,"ng-container"),e.j41(33,"ion-button",15),e.EFF(34,"Submit"),e.k0s()()()()}if(2&t){const n=e.sdS(24);e.R7$(8),e.Y8G("formGroup",i.entryForm),e.R7$(13),e.Dyx(i.temples),e.R7$(10),e.vxM("preset"===n.value?31:32)}},dependencies:[o.eP,o.Gp,o.he,u.MD,r.X1,r.qT,r.BC,r.cb,r.YS,r.tU,r.j4,r.JD,o.Jm,o.W9,o.eU,o.BC,o.ai,o.Nm,o.Ip,o.$w,o.QW,o.MC,o.uz]}),m})()}}]);