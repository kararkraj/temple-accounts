"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[693,953],{8573:(f,_,s)=>{s.r(_),s.d(_,{EditCharityTypePage:()=>p});var l=s(467),t=s(3953),i=s(4341),o=s(5751),v=s(7365),u=s(9228);let p=(()=>{var d;class a extends v.AddCharityTypePage{constructor(){super(...arguments),this.router=(0,t.WQX)(u.Ix)}ngOnInit(){var e=this;return(0,l.A)(function*(){e.title="Edit Service";try{e.charityType=yield e.charityTypeService.getCharityTypeById(e.charityTypeId),e.resetForm()}catch(r){e.toaster.presentToast({message:r.code,color:"danger"}),e.router.navigate(["tabs"],{replaceUrl:!0})}})()}onSubmit(){var e=this;return(0,l.A)(function*(){if(e.charityTypeForm.valid&&e.charityTypeForm.dirty){var r,c,y,m;const T={};null!==(r=e.charityTypeForm.get("name"))&&void 0!==r&&r.dirty&&(T.name=null===(c=e.charityTypeForm.get("name"))||void 0===c?void 0:c.value),null!==(y=e.charityTypeForm.get("amount"))&&void 0!==y&&y.dirty&&(T.amount=null===(m=e.charityTypeForm.get("amount"))||void 0===m?void 0:m.value);try{const h=yield e.charityTypeService.updateCharityType(e.charityTypeId,T);e.charityType={...e.charityType,...h},e.toaster.presentToast({message:"Service was updated successfully.",color:"success"})}catch(h){e.toaster.presentToast({message:`Error: ${h.code}`,color:"danger"}),console.error("Error updating document: ",h)}finally{e.resetForm()}}else e.charityTypeForm.valid?e.toaster.presentToast({message:"Nothing to update."}):e.charityTypeForm.markAllAsTouched()})()}resetForm(){this.charityTypeForm.reset(this.charityType)}}return(d=a).\u0275fac=(()=>{let n;return function(r){return(n||(n=t.xGo(d)))(r||d)}})(),d.\u0275cmp=t.VBU({type:d,selectors:[["app-edit-charity-type"]],standalone:!0,features:[t.Vt3,t.aNF],decls:21,vars:2,consts:[["slot","start"],["defaultHref","tabs/services"],[3,"ngSubmit","formGroup"],["lines","none"],["formControlName","name","label","Service Name *","label-placement","floating","placeholder","Enter service name","type","text","name","name","required","","maxlength","100","helperText","Only a-z, A-Z and 0-9 characters allowed","errorText","Only a-z, A-Z and 0-9 characters allowed"],["formControlName","amount","label","Service Amount *","label-placement","floating","placeholder","1001","type","number","name","amount","required","","min","1"],[1,"ion-no-padding"],["expand","full","type","button","color","light",3,"click"],["expand","full","type","submit"]],template:function(e,r){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t.nrm(3,"ion-back-button",1),t.k0s(),t.j41(4,"ion-title"),t.EFF(5),t.k0s()()(),t.j41(6,"ion-content")(7,"form",2),t.bIt("ngSubmit",function(){return r.onSubmit()}),t.j41(8,"ion-item-group")(9,"ion-item",3),t.nrm(10,"ion-input",4),t.k0s(),t.j41(11,"ion-item",3),t.nrm(12,"ion-input",5),t.k0s()(),t.j41(13,"ion-grid",6)(14,"ion-row")(15,"ion-col")(16,"ion-button",7),t.bIt("click",function(){return r.resetForm()}),t.EFF(17,"Reset"),t.k0s()(),t.j41(18,"ion-col")(19,"ion-button",8),t.EFF(20,"Submit"),t.k0s()()()()()()),2&e&&(t.R7$(5),t.JRh(r.title),t.R7$(2),t.Y8G("formGroup",r.charityTypeForm))},dependencies:[o.Jm,o.hU,o.lO,o.uz,o.jh,o.el,o.ln,o.QW,o.W9,o.eU,o.BC,o.ai,i.X1,i.qT,i.BC,i.cb,i.YS,i.tU,i.j4,i.JD,o.$w]}),a})()},1953:(f,_,s)=>{s.d(_,{y:()=>v});var l=s(467),t=s(3953),i=s(3026),o=s(5621);let v=(()=>{var u;class p{constructor(a,n){this.fireStore=a,this.auth=n,this.services=(0,t.vPA)([])}getCharityTypes(){var a=this;return(0,l.A)(function*(){return a.servicesListener?a.services():new Promise(n=>{var e;const r=(0,i.P)((0,i.rJ)(a.fireStore,"services"),(0,i._M)("createdBy","==",null===(e=a.auth.currentUser)||void 0===e?void 0:e.uid),(0,i._M)("isActive","==",!0));a.servicesListener=(0,i.aQ)(r,c=>{const y=c.docs.map(m=>({id:m.id,...m.data()}));a.services.set(y),n(y)})})})()}getCharityTypeById(a){var n=this;return(0,l.A)(function*(){const e=(0,i.H9)(n.fireStore,"services",a),r=yield(0,i.x7)(e);if(r.exists())return{id:r.id,...r.data()};throw{code:"permission-denied"}})()}addCharityType(a){var n=this;return(0,l.A)(function*(){try{var e;const r=(new Date).toISOString(),c={name:a.name,amount:a.amount,createdBy:null===(e=n.auth.currentUser)||void 0===e?void 0:e.uid,createdAt:r,updatedAt:r,isActive:!0};return{id:(yield(0,i.gS)((0,i.rJ)(n.fireStore,"services"),c)).id,...c}}catch(r){throw r}})()}updateCharityType(a,n){var e=this;return(0,l.A)(function*(){try{const r=(0,i.H9)(e.fireStore,"services",a);return n.updatedAt=(new Date).toISOString(),yield(0,i.mZ)(r,n),n}catch(r){throw r}})()}deleteCharityType(a){var n=this;return(0,l.A)(function*(){try{const e={isActive:!1};return yield n.updateCharityType(a,e)}catch(e){throw e}})()}}return(u=p).\u0275fac=function(a){return new(a||u)(t.KVO(i._7),t.KVO(o.Nj))},u.\u0275prov=t.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),p})()}}]);