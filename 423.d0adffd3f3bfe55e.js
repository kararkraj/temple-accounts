"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[423],{1423:(k,h,n)=>{n.r(h),n.d(h,{MyProfilePage:()=>E});var c=n(467),u=n(5621),w=n(2802),r=n(4341),a=n(5751),e=n(3953),y=n(7990),b=n(9228);function M(l,p){1&l&&(e.j41(0,"ion-row",8)(1,"ion-col")(2,"ion-note",22),e.EFF(3,"Password and confirm password do not match"),e.k0s()()())}function v(l,p){if(1&l){const d=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",2)(3,"ion-button",23),e.bIt("click",function(){e.eBV(d);const t=e.XpG();return e.Njj(t.cancel())}),e.EFF(4,"Cancel"),e.k0s()(),e.j41(5,"ion-title"),e.EFF(6,"Re-authenticate"),e.k0s()()(),e.j41(7,"ion-content",24)(8,"h4",25),e.EFF(9),e.k0s(),e.j41(10,"form",26),e.bIt("ngSubmit",function(){e.eBV(d);const t=e.XpG();return e.Njj(t.reAuthWithPassword())}),e.j41(11,"ion-grid",17)(12,"ion-row")(13,"ion-col")(14,"ion-input",27),e.mxI("ngModelChange",function(t){e.eBV(d);const s=e.XpG();return e.DH7(s.reAuthPassword,t)||(s.reAuthPassword=t),e.Njj(t)}),e.k0s()()(),e.j41(15,"ion-row")(16,"ion-col")(17,"ion-button",15),e.EFF(18,"Submit"),e.k0s()()()()()()}if(2&l){const d=e.XpG();e.R7$(9),e.JRh(d.modalMessage),e.R7$(5),e.R50("ngModel",d.reAuthPassword)}}let E=(()=>{var l;class p{constructor(o,t,s,i){this.auth=o,this.toaster=t,this.loader=s,this.router=i,this.checkPasswordMatch=m=>{var g,_;const f=null===(g=m.get("newPassword"))||void 0===g?void 0:g.value,P=null===(_=m.get("confirmNewPassword"))||void 0===_?void 0:_.value;return f&&P&&f!==P?{isPasswordMisMatch:!0}:null},this.user=this.auth.currentUser,this.myProfileForm=new r.gE({photoURL:new r.MJ(this.user.photoURL),displayName:new r.MJ(this.user.displayName,[r.k0.required,r.k0.maxLength(99)]),email:new r.MJ({value:this.user.email,disabled:!0},[r.k0.required,r.k0.maxLength(99),r.k0.email])}),this.updatePasswordForm=new r.gE({newPassword:new r.MJ(null,[r.k0.required,r.k0.minLength(8),r.k0.maxLength(99)]),confirmNewPassword:new r.MJ(null,[r.k0.required,r.k0.maxLength(99)])},{validators:this.checkPasswordMatch})}ngOnInit(){}onSubmit(){var o=this;return(0,c.A)(function*(){if(o.myProfileForm.pristine)o.toaster.presentToast({message:"Nothing to update.",color:"danger"});else if(o.myProfileForm.valid){const i=yield o.loader.create({message:"Updating profile... "});yield i.present();try{var t,s;null!==(t=o.myProfileForm.get("displayName"))&&void 0!==t&&t.dirty&&(yield(0,u.r7)(o.user,{displayName:null===(s=o.myProfileForm.get("displayName"))||void 0===s?void 0:s.value}),o.toaster.presentToast({message:"Profile is updated successfully.",color:"success"}))}catch(m){console.log(m),o.toaster.presentToast({message:`Error: ${m.code}`,color:"danger"})}finally{i.dismiss()}}else o.myProfileForm.markAllAsTouched()})()}resetForm(){this.myProfileForm.reset({...this.user}),this.disableEmailEdit()}deleteAccount(){var o=this;return(0,c.A)(function*(){const t=yield o.loader.create({message:"Deleting user... "});yield t.present(),(0,u.hG)(o.user).then(()=>{o.toaster.presentToast({message:"Account deleted.",color:"success"}),o.router.navigate(["login"],{replaceUrl:!0}),t.dismiss()})})()}updateEmail(){var o=this;return(0,c.A)(function*(){var t;const s=yield o.loader.create({message:"Sending verification email... "});yield s.present(),(0,u.g0)(o.user,null===(t=o.myProfileForm.get("email"))||void 0===t?void 0:t.value).then(i=>{console.log(i),o.toaster.presentToast({message:"Please click on the verification link sent to new email to complete the process.",color:"success"})}).catch(i=>{o.toaster.presentToast({message:`Error: ${i.code}`,color:"danger"})}).finally(()=>{s.dismiss()})})()}openModal(o,t){this.role=o,this.modalMessage=t,this.modal.present()}onWillDismiss(o){switch(this.role){case"delete":this.deleteAccount();break;case"updateEmail":this.updateEmail();break;case"updatePassword":this.updatePassword()}}cancel(){this.role="cancel",this.modal.dismiss("cancel")}reAuthWithPassword(){var o=this;return(0,c.A)(function*(){if(o.reAuthPassword){const t=yield o.loader.create({message:"Authenticating with email and password..."});yield t.present();try{const s=w.IX.credential(o.user.email,o.reAuthPassword);yield(0,u.kZ)(o.user,s),o.modal.dismiss()}catch(s){o.toaster.presentToast({message:`Error: ${s.code}`,color:"danger"})}finally{t.dismiss()}}else o.toaster.presentToast({message:"Password is required",color:"danger"})})()}enableEmailEdit(){var o;null===(o=this.myProfileForm.get("email"))||void 0===o||o.enable()}disableEmailEdit(){var o;null===(o=this.myProfileForm.get("email"))||void 0===o||o.disable()}onUpdatePasswordFormSubmit(){var o=this;return(0,c.A)(function*(){o.updatePasswordForm.valid?o.openModal("updatePassword","Please re-authenticate to confirm password update."):o.updatePasswordForm.markAllAsTouched()})()}updatePassword(){var o=this;return(0,c.A)(function*(){var t;const s=yield o.loader.create({message:"Updating password..."});yield s.present(),(0,u.f3)(o.user,null===(t=o.updatePasswordForm.get("newPassword"))||void 0===t?void 0:t.value).then(i=>{o.toaster.presentToast({message:"Password is updated successfully.",color:"success"})}).catch(i=>{o.toaster.presentToast({message:`Error: ${i.code}`,color:"danger"})}).finally(()=>{o.updatePasswordForm.reset(),s.dismiss()})})()}}return(l=p).\u0275fac=function(o){return new(o||l)(e.rXU(u.Nj),e.rXU(y.W),e.rXU(a.Xi),e.rXU(b.Ix))},l.\u0275cmp=e.VBU({type:l,selectors:[["app-my-profile"]],viewQuery:function(o,t){if(1&o&&e.GBs(a.Sb,5),2&o){let s;e.mGM(s=e.lsd())&&(t.modal=s.first)}},standalone:!0,features:[e.aNF],decls:50,vars:6,consts:[["modal",""],[3,"translucent"],["slot","start"],[1,"ion-padding",3,"fullscreen"],[3,"ngSubmit","formGroup"],[1,"ion-no-padding","ion-margin-top"],[1,"ion-justify-content-center"],["size","auto"],[1,"ion-margin-bottom"],["alt","Silhouette of a person's head",3,"src"],["formControlName","displayName","label","Display Name *","labelPlacement","stacked","fill","solid","name","displayName","type","text","spellcheck","false","autocapitalize","off","helperText","Only a-z, A-Z and 0-9 characters allowed","errorText","Only a-z, A-Z and 0-9 characters allowed","required","","minlength","2","maxlength","99",1,"ion-margin-bottom"],["formControlName","email","label","Email *","labelPlacement","stacked","fill","solid","name","email","type","text","spellcheck","false","autocapitalize","off","errorText","Invalid Email","required","","maxlength","99","placeholder","example@domain.com",1,"ion-margin-bottom"],[1,"ion-margin-bottom","action-buttons"],["type","button","color","danger","expand","full",3,"click"],["type","button","color","light","expand","full",3,"click"],["type","submit","color","primary","expand","full"],[1,"divider"],[1,"ion-no-padding"],[1,"ion-text-center"],["formControlName","newPassword","label","New password *","labelPlacement","stacked","fill","solid","name","newPassword","type","password","errorText","Use 8 characters or more for your new password","required","","maxlength","99","minlength","8"],["formControlName","confirmNewPassword","label","Confirm new password *","labelPlacement","stacked","fill","solid","name","confirmNewPassword","type","password","maxlength","99","required","","errorText","Confirm new password is required"],["backdropDismiss","false",3,"willDismiss"],["color","danger"],[3,"click"],[1,"ion-padding"],[1,"ion-no-margin","ion-margin-bottom"],[3,"ngSubmit"],["label","Password","labelPlacement","stacked","fill","solid","name","password","type","password","errorText","Password is required","required","","maxlength","99","placeholder","********","required","",1,"ion-margin-bottom",3,"ngModelChange","ngModel"]],template:function(o,t){if(1&o){const s=e.RV6();e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"My Profile"),e.k0s()()(),e.j41(6,"ion-content",3)(7,"form",4),e.bIt("ngSubmit",function(){return e.eBV(s),e.Njj(t.onSubmit())}),e.j41(8,"ion-grid",5)(9,"ion-row",6)(10,"ion-col",7)(11,"ion-avatar",8),e.nrm(12,"img",9),e.k0s()()(),e.j41(13,"ion-row")(14,"ion-col"),e.nrm(15,"ion-input",10),e.k0s()(),e.j41(16,"ion-row")(17,"ion-col"),e.nrm(18,"ion-input",11),e.k0s()(),e.j41(19,"ion-row",12)(20,"ion-col")(21,"ion-button",13),e.bIt("click",function(){return e.eBV(s),e.Njj(t.openModal("delete","Please re-authenticate to confirm deletion of your account."))}),e.EFF(22,"Delete account"),e.k0s()(),e.j41(23,"ion-col")(24,"ion-button",14),e.bIt("click",function(){return e.eBV(s),e.Njj(t.resetForm())}),e.EFF(25,"Reset"),e.k0s()(),e.j41(26,"ion-col")(27,"ion-button",15),e.EFF(28,"Submit"),e.k0s()()(),e.nrm(29,"ion-row",16),e.k0s()(),e.j41(30,"form",4),e.bIt("ngSubmit",function(){return e.eBV(s),e.Njj(t.onUpdatePasswordFormSubmit())}),e.j41(31,"ion-grid",17)(32,"ion-row")(33,"ion-col")(34,"h4",18),e.EFF(35," Update Password "),e.k0s()()(),e.j41(36,"ion-row",8)(37,"ion-col"),e.nrm(38,"ion-input",19),e.k0s()(),e.j41(39,"ion-row",8)(40,"ion-col"),e.nrm(41,"ion-input",20),e.k0s()(),e.DNE(42,M,4,0,"ion-row",8),e.j41(43,"ion-row")(44,"ion-col")(45,"ion-button",15),e.EFF(46,"Submit"),e.k0s()()()()(),e.j41(47,"ion-modal",21,0),e.bIt("willDismiss",function(m){return e.eBV(s),e.Njj(t.onWillDismiss(m))}),e.DNE(49,v,19,2,"ng-template"),e.k0s()()}2&o&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("formGroup",t.myProfileForm),e.R7$(5),e.Y8G("src",t.user.photoURL||"./../../../assets/avatar.svg",e.B4B),e.R7$(18),e.Y8G("formGroup",t.updatePasswordForm),e.R7$(12),e.vxM(t.updatePasswordForm.hasError("isPasswordMisMatch")?42:-1))},dependencies:[a.JI,r.YN,r.qT,r.BC,r.cb,r.YS,r.xh,r.tU,r.vS,r.cV,a.Sb,a.Jm,r.X1,r.j4,r.JD,a.$w,a.hU,a.ln,a.lO,a.mC,a.QW,a.W9,a.eU,a.BC,a.ai,a.MC],styles:["ion-avatar[_ngcontent-%COMP%]{--border-radius: 4px}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{min-height:44px}ion-row.divider[_ngcontent-%COMP%]{border:1px solid var(--ion-color-primary)}"]}),p})()}}]);