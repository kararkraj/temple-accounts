"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[797],{7797:(O,v,c)=>{c.r(v),c.d(v,{AddEntryPage:()=>D});var p=c(467),l=c(4341),a=c(5751),e=c(3953),E=c(9650),C=c(4987),S=c(7990);const A=["ionSegment"],T=(i,s)=>s.id;function b(i,s){1&i&&e.nrm(0,"ion-menu-button")}function F(i,s){1&i&&e.nrm(0,"ion-back-button",2)}function P(i,s){if(1&i&&(e.j41(0,"ion-select-option",14),e.EFF(1),e.k0s()),2&i){const r=s.$implicit;e.Y8G("value",r),e.R7$(),e.JRh(r.name)}}function j(i,s){if(1&i&&(e.j41(0,"ion-select-option",14),e.EFF(1),e.k0s()),2&i){const r=s.$implicit;e.Y8G("value",r),e.R7$(),e.Lme("",r.name," - (Rs. ",r.amount,")")}}function k(i,s){if(1&i){const r=e.RV6();e.j41(0,"ion-item",5)(1,"ion-select",18),e.bIt("selectionChange",function(n){e.eBV(r);const o=e.XpG(2);return e.Njj(o.onCharityTypeSelection(n))}),e.Z7z(2,j,2,3,"ion-select-option",14,T),e.k0s()()}if(2&i){const r=e.XpG(2);e.R7$(2),e.Dyx(r.charityTypes)}}function N(i,s){1&i&&(e.qex(0),e.j41(1,"ion-item",19),e.nrm(2,"ion-input",20),e.k0s(),e.j41(3,"ion-item",19),e.nrm(4,"ion-input",21),e.k0s(),e.bVm())}function x(i,s){if(1&i){const r=e.RV6();e.j41(0,"ion-item",5)(1,"ion-select",13),e.bIt("selectionChange",function(n){e.eBV(r);const o=e.XpG();return e.Njj(o.onTempleSelection(n))}),e.Z7z(2,P,2,2,"ion-select-option",14,T),e.k0s()(),e.j41(4,"ion-segment",15,0),e.bIt("ionChange",function(n){e.eBV(r);const o=e.XpG();return e.Njj(o.onSegmentChange(n.target.value))}),e.j41(6,"ion-segment-button",16)(7,"ion-label"),e.EFF(8,"Preset services"),e.k0s()(),e.j41(9,"ion-segment-button",17)(10,"ion-label"),e.EFF(11,"Custom service"),e.k0s()()(),e.DNE(12,k,4,0,"ion-item",5)(13,N,5,0,"ng-container")}if(2&i){const r=e.sdS(5),t=e.XpG();e.R7$(2),e.Dyx(t.temples),e.R7$(10),e.vxM("preset"===r.value?12:13)}}function R(i,s){if(1&i){const r=e.RV6();e.j41(0,"ion-col")(1,"ion-button",22),e.bIt("click",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.resetForm())}),e.EFF(2,"Reset"),e.k0s()()}}let D=(()=>{var i;class s{constructor(t,n,o,m,d){this.entryService=t,this.formBuilder=n,this.pdfService=o,this.loader=m,this.toaster=d,this.title="Add entry",this.isEdit=!1,this.temples=[],this.charityTypes=[],this.entryForm=this.formBuilder.group({title:[null,[l.k0.required]],name:[null,[l.k0.required,l.k0.maxLength(100),l.k0.pattern("[a-zA-Z0-9 ]+")]],temple:[null,[l.k0.required]],charityType:[null,[l.k0.required]],charityTypeName:[null,[l.k0.required,l.k0.maxLength(50)]],charityTypeAmount:[null,[l.k0.required,l.k0.min(1)]]})}ngOnInit(){}ionViewWillEnter(){this.getTemples(),this.getCharityTypes()}getTemples(){var t=this;return(0,p.A)(function*(){t.temples=yield t.entryService.getTemples(),1===t.temples.length&&t.entryForm.patchValue({temple:t.temples[0]})})()}getCharityTypes(){var t=this;return(0,p.A)(function*(){t.charityTypes=yield t.entryService.getCharityTypes(),t.onPresetServiceSelection(),t.ionSegment.writeValue(t.charityTypes.length>0?"preset":"custom"),t.onSegmentChange(t.ionSegment.value)})()}onSubmit(){var t=this;return(0,p.A)(function*(){if(t.entryForm.valid){var n,o,m,d,y,_;const f=yield t.loader.create({message:"Adding entry..."});yield f.present();const h=null===(n=t.entryForm.get("charityType"))||void 0===n?void 0:n.value,g=null===(o=t.entryForm.get("temple"))||void 0===o?void 0:o.value;let M={title:null===(m=t.entryForm.get("title"))||void 0===m?void 0:m.value,name:null===(d=t.entryForm.get("name"))||void 0===d?void 0:d.value,templeName:g.name,templeAddress:g.address,templeId:g.id,charityTypeId:"custom"===t.ionSegment.value?"":h.id,charityTypeAmount:"custom"===t.ionSegment.value?null===(y=t.entryForm.get("charityTypeAmount"))||void 0===y?void 0:y.value:h.amount,charityTypeName:"custom"===t.ionSegment.value?null===(_=t.entryForm.get("charityTypeName"))||void 0===_?void 0:_.value:h.name};try{const u=yield t.entryService.addEntry(M);t.toaster.presentToast({message:"Entry was added successfully.",color:"success"}),t.pdfService.generateAndDownloadPDF(u)}catch(u){t.toaster.presentToast({message:`Error: ${u.code}`,color:"danger"}),console.error("Error adding document: ",u)}finally{t.resetForm(),f.dismiss()}}else t.entryForm.markAllAsTouched()})()}onTempleSelection(t){}onCharityTypeSelection(t){}onSegmentChange(t){"custom"===t?this.onCustomServiceSelection():this.onPresetServiceSelection()}onPresetServiceSelection(){var t,n,o,m;0===this.charityTypes.length&&this.toaster.presentToast({message:"No preset services found. Go to Services => Add Service to add preset services.",color:"danger",duration:5e3}),null===(t=this.entryForm.get("charityTypeName"))||void 0===t||t.disable(),null===(n=this.entryForm.get("charityTypeAmount"))||void 0===n||n.disable(),null===(o=this.entryForm.get("charityType"))||void 0===o||o.enable(),null===(m=this.entryForm.get("charityType"))||void 0===m||m.reset(),1===this.charityTypes.length&&this.entryForm.patchValue({charityType:this.charityTypes[0]})}onCustomServiceSelection(){var t,n,o;null===(t=this.entryForm.get("charityType"))||void 0===t||t.disable(),null===(n=this.entryForm.get("charityTypeName"))||void 0===n||n.enable(),null===(o=this.entryForm.get("charityTypeAmount"))||void 0===o||o.enable()}resetForm(){let t={};1===this.temples.length&&(t.temple=this.temples[0]),1===this.charityTypes.length&&(t.charityType=this.charityTypes[0]),this.entryForm.reset(t)}}return(i=s).\u0275fac=function(t){return new(t||i)(e.rXU(E.q),e.rXU(l.ok),e.rXU(C.C),e.rXU(a.Xi),e.rXU(S.W))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-add-entry"]],viewQuery:function(t,n){if(1&t&&e.GBs(A,5),2&t){let o;e.mGM(o=e.lsd())&&(n.ionSegment=o.first)}},standalone:!0,features:[e.aNF],decls:27,vars:5,consts:[["ionSegment",""],["slot","start"],["defaultHref","tabs/entries"],[1,"container"],[3,"ngSubmit","formGroup"],["lines","full"],["formControlName","title","label","Title *","label-placement","floating","placeholder","Select title","required","","name","title"],["value","Sri."],["value","Smt."],["value","Kum."],["formControlName","name","label","Name *","label-placement","floating","placeholder","Enter name","type","text","name","name","required","","helperText","Only a-z, A-Z and 0-9 characters allowed","errorText","Only a-z, A-Z and 0-9 characters allowed"],[1,"ion-no-padding"],["expand","full","type","submit"],["formControlName","temple","label","Temple *","label-placement","floating","placeholder","Select temple","required","","name","temple",3,"selectionChange"],[3,"value"],["value","preset",1,"ion-justify-content-start",3,"ionChange"],["value","preset"],["value","custom"],["formControlName","charityType","label","Service *","label-placement","floating","placeholder","Select service","required","","name","service",3,"selectionChange"],["lines","none"],["formControlName","charityTypeName","label","Service Name *","label-placement","floating","placeholder","Enter service name","type","text","name","charityTypeName","required","","maxlength","50","helperText","Only a-z, A-Z and 0-9 characters allowed","errorText","Only a-z, A-Z and 0-9 characters allowed"],["formControlName","charityTypeAmount","label","Service Amount *","label-placement","floating","placeholder","1001","type","number","name","charityTypeAmount","equired","","min","1"],["expand","full","type","button","color","light",3,"click"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),e.DNE(3,b,1,0,"ion-menu-button")(4,F,1,0,"ion-back-button",2),e.k0s(),e.j41(5,"ion-title"),e.EFF(6),e.k0s()()(),e.j41(7,"ion-content")(8,"div",3)(9,"form",4),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(10,"ion-item",5)(11,"ion-select",6)(12,"ion-select-option",7),e.EFF(13,"Sri. (Shriman)"),e.k0s(),e.j41(14,"ion-select-option",8),e.EFF(15,"Smt. (Shrimati)"),e.k0s(),e.j41(16,"ion-select-option",9),e.EFF(17,"Kum. (Kumar/Kumari)"),e.k0s()()(),e.j41(18,"ion-item",5),e.nrm(19,"ion-input",10),e.k0s(),e.DNE(20,x,14,1),e.j41(21,"ion-grid",11)(22,"ion-row"),e.DNE(23,R,3,0,"ion-col"),e.j41(24,"ion-col")(25,"ion-button",12),e.EFF(26,"Submit"),e.k0s()()()()()()()),2&t&&(e.R7$(3),e.vxM(n.isEdit?4:3),e.R7$(3),e.JRh(n.title),e.R7$(3),e.Y8G("formGroup",n.entryForm),e.R7$(11),e.vxM(n.isEdit?-1:20),e.R7$(3),e.vxM(n.isEdit?23:-1))},dependencies:[a.hU,a.ln,a.lO,a.el,a.eP,a.Gp,a.he,l.X1,l.qT,l.BC,l.cb,l.YS,l.tU,l.j4,l.JD,a.Jm,a.W9,a.eU,a.BC,a.ai,a.Nm,a.Ip,a.$w,a.QW,a.MC,a.uz]}),s})()}}]);